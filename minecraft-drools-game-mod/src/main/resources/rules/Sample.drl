package com.example
 
import org.drools.minecraft.model.Room;
import org.drools.minecraft.model.Session;
import org.drools.minecraft.model.Player;
import org.drools.minecraft.model.Item;
import org.drools.minecraft.model.Door;
import org.drools.minecraft.util.DroolsCommandInterface;
import org.drools.minecraft.util.DroolsTestInterface;
import org.drools.minecraft.model.Event;

import java.util.ArrayList;

rule "Setup"
    when
        $startup : Event(id == "Setup" && !hasFired)
    then
        ArrayList<Item> chestContents = new ArrayList<Item>();
        chestContents.add(new Item("key", 1));
        chestContents.add(new Item("bread", 12));
        
        DroolsCommandInterface.placeChest(-91, 64, 433, 0, chestContents);
        $startup.setHasFired(true);
end


rule "Update"
no-loop
    when
        //I'm a stub, and maybe should go away entirely!
    then
        //I'm still a stub!
        
end

rule "Open the door when the player has the key"
    when
        $d : Door(id == "LighthouseDoor")
        $p : Player(DroolsTestInterface.playerTouchingDoor($p, $d))
        Item(type == "item.key") from $p.getInventory()
        
    then
       DroolsCommandInterface.openDoor($d);

end

rule "Close the door when we're not around."
    when
        $d : Door(id == "LighthouseDoor")
        $p : Player(!DroolsTestInterface.playerTouchingDoor($p, $d))
        
    then
       DroolsCommandInterface.closeDoor($d);

end